<ion-header hideWhen="core">
	<page-bsc-header ></page-bsc-header>
</ion-header>

<ion-content>

	<page-bsc-header header="Buy Travel Pass" showWhen="core"></page-bsc-header>

	<h2 hideWhen='core' class="mobile-sub-header">TRAVEL PASS</h2>
	<h2 showWhen='core' class="core-sub-header">TRAVEL PASS</h2>


	<ion-grid class = "selected-grid">
		<ion-row>
			<ion-col >
				<h3 [hidden]='!ticketsSaved' class="page-paddingtext">Travel Pass Price</h3>
			</ion-col>
		</ion-row>

		<ion-row>
			<ion-col>
				<h6 [hidden]='!ticketsSaved'  class="page-paddingtext">Must be Purchased Prior to Bali Arrival</h6>
			</ion-col>
		</ion-row>

		<ion-row>
			<ion-col>
				<h3 [hidden]='!ticketsSaved' class="page-paddingtext">Select Travel Pass Requirements</h3>
			</ion-col>
		</ion-row>

		<ion-row [hidden]='!ticketsSaved' class = "box1-content" align-items: center  *ngFor="let ticket of bundleViewDescription">
			<ion-col col-12 align-items: center >
				<ion-row class = "border-element1">
					<ion-col>
						<ion-row>
							<ion-col>
								<button class = "counter-btn" float-left clear (click)="decrementValue(ticket)">
									<ion-icon name="remove" ></ion-icon>
								</button>
							</ion-col>
							<ion-col class = "vertical">
								<p>{{ticket.quantity}}</p>
							</ion-col>
							<ion-col>
								<button class = "counter-btn" clear (click)="incrementValue(ticket)" float-right>
									<ion-icon name="md-add" ></ion-icon>
								</button>
							</ion-col>
						</ion-row>
					</ion-col>
					<ion-col col-4 class = "static-ctext">
						<p class = "unit-component">
							<b>1 {{ticket.title}}: $</b>
						</p>
					</ion-col>
					<ion-col col-4 class = "vertical">
						<p>{{ticket.price}}</p>
					</ion-col>
				</ion-row>
			</ion-col>

			<ion-col col-12>
				<p class="page-text">{{ticket.description}}</p>
				<p class="page-text">{{ticket.valid_days}}</p>
			</ion-col>
		</ion-row>

		<ion-row [hidden]='ticketsSaved'>
			<ion-col>
				<h5 class = "center-msg">You have selected the following Travel Pass</h5>
			</ion-col>
		</ion-row>

		<div class = "save-btn">
		<button [hidden]='!ticketsSaved' ion-button color='primary' (click)='savePressed()'>Save</button>
		</div>

		<ion-row  [hidden]='ticketsSaved' class = "box2-content">
			<ion-col>
				<ion-row class="grid-row" *ngFor="let ticket of bundleSaveTickets">
					<ion-col>
						<p>Quantity <span class="green-text bold-text">{{ticket.quantity}}</span></p>
					</ion-col>

					<ion-col>
						<h5>{{ticket.ticket_type}}</h5>
					</ion-col>

					<ion-col>
						<p>Price <span class="green-text bold-text">${{ticket.price}}</span></p>
					</ion-col>
				</ion-row>

				<ion-row>
					<ion-col>
						<p>
							<b>TOTAL PRICE : <span class="green-text bold-text">${{finalCost}}</span></b>
						</p>
					</ion-col>
				</ion-row>
			</ion-col>
		</ion-row>

	</ion-grid>

	<div class = "save-btn" >
		<button [hidden]='ticketsSaved || !travellerInfoWindow' ion-button color='primary' (click)='editPressed()'>Edit Tickets</button>
	</div>

	<div class = "save-btn" >
		<button [hidden]='ticketsSaved || paymentView' ion-button color='primary' (click)='continuePressed()'>Continue</button>
	</div>

	<h5 style="text-align: center; color: red;" [hidden] = 'travellerInfoWindow'>Please Fill The Customer Details Travelling to Bali</h5>

	<form #ticketDetailsEntry="ngForm" novalidate>
	<ion-grid [hidden]= 'travellerInfoWindow'>
		<ion-row class='form-row' *ngFor='let traveller of arrayTravellers'>
			<ion-col class='form-col'>
				<div class="form-panel">
					
					    <ion-list no-lines>
					    	<p><b>Ticket Type :</b> {{traveller.ticket_type}} {{traveller.ticket_sub_type}}</p>
					    	<ion-item class='form-item'>
						        <ion-input [(ngModel)]="traveller.first_name" name="firstName" type="text" #firstName="ngModel" spellcheck="false" autocapitalize="off" required placeholder='First Name' >
						        </ion-input>
					      	</ion-item>
						      <p ion-text [hidden]="traveller.first_name != '' || travellerFormSubmitted == false" color="danger" padding-left>
						        First Name is required
						      </p>

						      <br>

						    <ion-item class='form-item'>
						        <ion-input [(ngModel)]="traveller.last_name" name="lastName" type="text" #lastName="ngModel" spellcheck="false" autocapitalize="off" required placeholder='Last Name'>
						        </ion-input>
					      	</ion-item>
						      <p ion-text [hidden]="traveller.last_name != '' || travellerFormSubmitted == false" color="danger" padding-left>
						        Last Name is required
						      </p>

						      <br>

						      <ion-item class='form-item'>
						        <ion-input [(ngModel)]="traveller.email" name="email" type="email" #email="ngModel" spellcheck="false" autocapitalize="off" required ngModel email placeholder='Email'>
						        </ion-input>
						      </ion-item>
						      <p ion-text [hidden]="email.valid || travellerFormSubmitted == false" color="danger" padding-left>
						        Enter a valid email
						      </p>

						      <br>						  						    

						      <ion-item class='form-item'>
						        <ion-input [(ngModel)]="traveller.date_of_birth" name="dob" #dob="ngModel" spellcheck="false" autocapitalize="off" value='' required ngModel type='text' placeholder='Date Of Birth' 
						        onfocus="(this.type='date')" onblur="(this.type='text')">
						        </ion-input>
						      </ion-item>
						      <p ion-text [hidden]="dob.valid || travellerFormSubmitted == false" color="danger" padding-left>
						        Enter date of birth
						      </p>

						      <br>

							    <ion-item class='form-item'>
								  	<ion-select [(ngModel)]="traveller.gender" name='gender' #gender="ngModel" required placeholder='Gender'>
								  		<ion-option value="0">Male</ion-option>
								    	<ion-option value="1">Female</ion-option>
								   		<ion-option value="2">Transgender</ion-option>
									</ion-select>
								</ion-item>
								<p ion-text [hidden]="traveller.gender != '' || travellerFormSubmitted == false " color="danger" padding-left>
							        Select gender
							    </p>

						</ion-list>
					
  				</div>
			</ion-col>
		</ion-row>

		<div class = "save-btn" >
	        	<button ion-button color='primary' (click)='buttonSubmitPressed(ticketDetailsEntry)'>Submit Traveller Details</button>
	    </div>
	      
	</ion-grid>
	</form>


	<ion-grid class = "selected-grid2" [hidden]='!paymentView || !travellerInfoWindow'>
	   	<ion-row class = "grid-row">
			<ion-col>

				<ion-input [(ngModel)]="cardDetails.number" #number="ngModel" name="cardNumber" type="tel" spellcheck="false"  pInputText (keypress)="validateCard($event)" maxlength="19"  autocapitalize="off" required ngModel placeholder='* CARD NUMBER'>

	            </ion-input>
	        </ion-col>
		</ion-row>

		<ion-row class = "grid-row">
			<ion-col> 

				<ion-input [(ngModel)]="cardDetails.cvc" #cvc="ngModel"  pInputText (keypress)="onlyNumberKey($event)" maxlength="4" name="cvc" type="tel" spellcheck="false" autocapitalize="off" required ngModel placeholder='* CVC'>

                </ion-input>
            </ion-col>

			<ion-col>

				<ion-input [(ngModel)]="cardDetails.expMonth" #expMonth="ngModel"  name="mm" type="tel" spellcheck="false" autocapitalize="off" required ngModel placeholder='* MM'  pInputText (keypress)="onlyNumberKey($event)" maxlength="2" >

	            </ion-input>
	        </ion-col>

	        <ion-col>

                <ion-input [(ngModel)]="cardDetails.expYear" #expYear="ngModel" name="yy" type="tel" spellcheck="false" autocapitalize="off" required ngModel placeholder='* YY'  pInputText (keypress)="onlyNumberKey($event)" maxlength="2" >

                </ion-input>
            </ion-col>
		</ion-row>
		
		<ion-row>
			<div class = "save-btn" >
				<button ion-button color='primary' (click)='makePayment()'>Proceed to pay</button>
			</div>
		</ion-row>
	</ion-grid>

		
	<page-bsc-footer></page-bsc-footer>
</ion-content>



